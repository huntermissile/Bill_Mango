<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mango Role Revenue Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #fefcea, #f1da36);
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 90%;
      width: 700px;
      margin: 40px auto;
      background-color: #fff8dc;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      border-radius: 16px;
    }
    h1, h2 {
      text-align: center;
      color: #f57f17;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, select, button {
      width: 100%;
      padding: 14px;
      margin-top: 8px;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 16px;
    }
    button {
      background-color: #f9a825;
      color: white;
      border: none;
      margin-top: 20px;
      font-weight: bold;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      background-color: #f57f17;
      transform: scale(1.03);
    }
    .result, .input-set, .grand-total-box {
      margin-top: 30px;
      padding: 20px;
      border-radius: 12px;
      background-color: #fffde7;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    .grand-total-box {
      background-color: #f1f8e9;
      border: 2px dashed #388e3c;
      text-align: center;
      font-weight: bold;
      font-size: 20px;
      color: #1b5e20;
    }
    @media (max-width: 600px) {
      .container {
        padding: 20px;
        margin: 20px;
      }
      h1 {
        font-size: 22px;
      }
    }
    @media print {
      input, button, select, #advanceSection, .container > h1 {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Mango Revenue Estimator</h1>
    <label for="role">Select Your Role:</label>
    <select id="role">
      <option value="farmer">Farmer</option>
      <option value="vyapari">Vyapari</option>
    </select>
    <label for="lots">Number of Lots:</label>
    <input type="number" id="lots" min="1">
    <button onclick="generateInputs()">Generate Lot Inputs</button>
    <form id="lotInputs"></form>
    <div id="advanceSection" style="display:none">
      <label for="advance">Advance:</label>
      <input type="number" id="advance" value="0">
      <label for="baardana">Include Baardana (Farmer Only)</label>
      <select id="baardana">
        <option value="1">Yes</option>
        <option value="0">No</option>
      </select>
      <button onclick="calculateRevenue()">Calculate Revenue</button>
    </div>
    <div id="result"></div>
  </div>
  <script>
    function generateInputs() {
      const form = document.getElementById('lotInputs');
      form.innerHTML = '';
      const lots = parseInt(document.getElementById('lots').value);
      for (let i = 1; i <= lots; i++) {
        const field = document.createElement('div');
        field.className = 'input-set';
        field.innerHTML = `
          <h3 style="color:#f57f17;">Lot No. ${i}</h3>
          <label>Number of Carats:</label>
          <input type="number" class="boxes" required>
          <label>Weight of Mango (kgs):</label>
          <input type="number" class="weight" required>
          <label>Rate per Kg:</label>
          <input type="number" class="price" required>
        `;
        form.appendChild(field);
      }
      document.getElementById('advanceSection').style.display = 'block';
      document.getElementById('result').innerHTML = '';
    }

    function calculateRevenue() {
      const role = document.getElementById('role').value;
      const includeBaardana = parseInt(document.getElementById('baardana').value);
      const boxes = document.querySelectorAll('.boxes');
      const weights = document.querySelectorAll('.weight');
      const prices = document.querySelectorAll('.price');
      const advance = parseFloat(document.getElementById('advance').value);

      let totalRevenue = 0;
      let totalBoxes = 0;
      let resultHTML = '';

      for (let i = 0; i < boxes.length; i++) {
        const b = parseFloat(boxes[i].value);
        const w = parseFloat(weights[i].value);
        const p = parseFloat(prices[i].value);
        const boxWeight = b * 2;
        const reducedWeight = w - boxWeight;
        const rawLoss = reducedWeight * 0.05;
        let loss = Math.floor(rawLoss);
        if (role === 'farmer') {
          const decimal = rawLoss - Math.floor(rawLoss);
          if (decimal > 0.7) loss = Math.ceil(rawLoss);
        }
        const finalWeight = reducedWeight - loss;
        const revenue = finalWeight * p;

        resultHTML += `
          <div class="input-set">
            <h3>Lot No. ${i + 1}</h3>
            Total Weight: ${w} kg<br>
            Total Carat Weight: ${boxWeight} kg<br>
            Weight left: ${reducedWeight} kg<br>
            5% Loss: ${loss} kg<br>
            Net Weight: ${finalWeight} kg<br>
            Rate per Kg: Rs. ${p}<br>
            <strong>Revenue: Rs. ${revenue.toFixed(2)}</strong>
          </div>`;

        totalRevenue += revenue;
        totalBoxes += b;
      }

      const cmn = Math.floor(totalRevenue * 0.07);
      const pl = totalBoxes * 5;
      const br = (role === 'farmer' && includeBaardana === 1) ? totalBoxes * 5 : 0;
      const rp = 5;
      let grandTotal, expense = 0;

      if (role === 'farmer') {
        expense = advance + pl + br + cmn + rp;
        grandTotal = totalRevenue - expense;
      } else {
        grandTotal = totalRevenue + pl + cmn + 10;
      }

      resultHTML += `
        <div class="result">
          <strong>Total Revenue:</strong> Rs. ${totalRevenue.toFixed(2)}<br>
          <strong>Commission:</strong> Rs. ${cmn}<br>
          <strong>Palledari:</strong> Rs. ${pl}<br>
          ${role === 'farmer' ? `<strong>Baardana:</strong> Rs. ${br}<br>` : ''}
          ${role === 'farmer' ? `<strong>Advance:</strong> Rs. ${advance}<br>` : ''}
          ${role === 'farmer' ? `<strong>Receipt:</strong> Rs. ${rp}<br>` : '<strong>Fixed Addition:</strong> Rs. 10<br>'}
          ${role === 'farmer' ? `<strong>Expense:</strong> Rs. ${expense}<br>` : ''}
        </div>
        <div class="grand-total-box">
          Grand Total: Rs. ${grandTotal.toFixed(2)}
        </div>
      `;

      document.getElementById('result').innerHTML = resultHTML;
    }
  </script>
</body>
</html>